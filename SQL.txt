-- Create product table
CREATE TABLE `product` (
  `productId` INT(11) NOT NULL AUTO_INCREMENT,
  `category` ENUM(
    'COMPTE_COURANT',
    'COMPTE_EPARGNE',
    'COMPTE_PREMIUM',
    'COMPTE_JEUNE',
    'COMPTE_ENTREPRISE',
    'CARTE_DEBIT',
    'CARTE_CREDIT',
    'CARTE_PREMIUM',
    'CARTE_VIRTUELLE',
    'EPARGNE_CLASSIQUE',
    'EPARGNE_LOGEMENT',
    'DEPOT_A_TERME',
    'PLACEMENT_INVESTISSEMENT',
    'ASSURANCE_VIE',
    'ASSURANCE_HABITATION',
    'ASSURANCE_VOYAGE'
  ) NOT NULL DEFAULT 'COMPTE_COURANT',
  `price` DOUBLE NOT NULL,
  `description` VARCHAR(500) NOT NULL,
  `createdAt` DATE NOT NULL,
  PRIMARY KEY (`productId`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci AUTO_INCREMENT=7;

-- Create productsubscription table
CREATE TABLE `productsubscription` (
  `subscriptionId` INT(11) NOT NULL AUTO_INCREMENT,
  `client` INT(11) NOT NULL,
  `product` INT(11) NOT NULL,
  `type` ENUM('MONTHLY', 'ANNUAL', 'TRANSACTION', 'ONE_TIME') NOT NULL,
  `subscriptionDate` DATE NOT NULL,
  `expirationDate` DATE NOT NULL,
  `status` ENUM('DRAFT', 'ACTIVE', 'SUSPENDED', 'CLOSED') NOT NULL,
  PRIMARY KEY (`subscriptionId`),
  KEY `fk_subscription_product` (`product`),
  CONSTRAINT `fk_subscription_product` FOREIGN KEY (`product`) 
    REFERENCES `product` (`productId`) 
    ON DELETE CASCADE
    ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci AUTO_INCREMENT=14;


-- Create wallet table
CREATE TABLE wallet (
    id_wallet INT PRIMARY KEY AUTO_INCREMENT,
    nom_proprietaire VARCHAR(100) NOT NULL,
    solde DOUBLE NOT NULL,
    devise VARCHAR(10) NOT NULL,
    statut VARCHAR(20) NOT NULL,
    date_creation DATETIME NOT NULL
);
CREATE TABLE transaction (
    id_transaction INT PRIMARY KEY AUTO_INCREMENT,
    montant DOUBLE NOT NULL,
    type VARCHAR(20) NOT NULL,
    date_transaction DATETIME NOT NULL,
    id_wallet INT NOT NULL,
    FOREIGN KEY (id_wallet) REFERENCES wallet(id_wallet)
        ON DELETE CASCADE
);

